<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Cart — EMMY APPAREL</title>
    <link rel="stylesheet" href="styles/index.css" />
    <link rel="stylesheet" href="styles/cart.css" />
    <!-- jsPDF for client-side PDF generation (used for invoice creation) -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js" defer></script>
    <script defer src="scripts/cart.js"></script>
    <style>
      /* Add black shadow to cart rows rendered by JS */
      .cart-row.shadow-black{ box-shadow: 0 16px 40px rgba(0,0,0,0.30) !important; }
      .cart-row.shadow-black:hover{ box-shadow: 0 22px 56px rgba(0,0,0,0.36) !important; transform: translateY(-4px); }
      /* Empty cart image: show at near-full size but slightly smaller, keep aspect ratio */
      .cart-empty .emptycart-img {
        width: 320px;
        max-width: 86%;
        height: auto;
        object-fit: contain;
        display: block;
        margin: 0 0 12px auto; /* align right by default, center if necessary */
        border-radius: 6px;
      }
        /* Close button: circular, subtle shadow, slightly lowered */
        .close-btn {
          background: #000;
          color: #fff;
          width: 44px;
          height: 44px;
          display: inline-flex;
          align-items: center;
          justify-content: center;
          font-size: 20px;
          line-height: 1;
          border: none;
          border-radius: 50%;
          box-shadow: 0 6px 18px rgba(0,0,0,0.18);
          cursor: pointer;
          margin-top: 50px; /* bring down a bit */
          margin-left: 6px;
          font-weight: 700;
          transition: transform .12s ease, box-shadow .12s ease, opacity .12s ease;
        }
        .close-btn:hover { transform: translateY(0); box-shadow: 0 10px 22px rgba(0,0,0,0.22); opacity: 0.98; }
        .close-btn:focus { outline: 3px solid rgba(0,0,0,0.12); }
    </style>
  </head>
  <body>
    <div class="container">
      <header class="header">
        <!-- Close button replaces logo: returns user to previous page/referrer -->
        <button class="close-btn" aria-label="Close cart">×</button>
        <div class="icons-right">
          <a class="notif-btn" href="cart.html" aria-label="Cart" aria-haspopup="true" aria-expanded="false">
            <img src="icons/cart.svg" alt="Cart" width="20" height="20" aria-hidden="true" />
            <span class="notif-badge" aria-hidden="false">0</span>
          </a>
        </div>
      </header>

      <main class="main-content" tabindex="-1">
        <section class="cart-section">
          <h1 class="cart-title">Cart</h1>

          <!-- Primary 'Continue shopping' CTA shown when cart has items -->
          <div style="margin-bottom:12px; display:none;" id="continue-shopping-wrap">
            <a id="continue-shopping-btn" class="buy-now-btn" href="index.html" style="display:inline-block;">Continue shopping</a>
          </div>

          <div id="cart-list" class="cart-list">
            <!-- cart rows rendered by scripts/cart.js -->
          </div>

          <!-- Empty cart message (placed above Address) -->
          <div class="cart-empty" id="cart-empty" hidden>
            <img src="images/emptycart.jpg" alt="Empty cart" class="emptycart-img" />
          
            <h3>Your cart is empty</h3>
            <p>Browse our collections and add items to the cart.</p>
            <a class="buy-now-btn" href="index.html">Continue shopping</a>
          </div>

          <!-- Contact (name + phone) input section — same save/delete UI as address -->
          <section class="contact-section">
            <h2 class="section-label"><img src="media%20icons/phone.png" alt="" class="section-label-icon" width="18" height="18" aria-hidden="true">Contact</h2>
            <div class="contact-panel">
              <div class="contact-fields-wrapper">
                <input id="contact-name-field" class="contact-field" type="text" placeholder="Enter your full name" value="" aria-label="Full name" />
                <div id="contact-name-error" class="input-error" hidden>Full name is required</div>
                <input id="contact-phone-field" class="contact-field" type="tel" placeholder="Enter your phone number" value="" aria-label="Phone number" inputmode="tel" pattern="^[0-9+\-]{10,18}$" maxlength="18" minlength="10" />
                <div id="contact-phone-error" class="input-error" hidden>Phone number must be 10–14 digits</div>
                <div id="contact-required-error" class="input-error" hidden>Name and phone number required</div>
              </div>
              <div class="contact-actions address-actions">
                <button id="contact-save-btn" class="address-action-btn icon-btn btn-primary" aria-label="Save contact" disabled>
                  <svg width="18" height="18" viewBox="0 0 24 24" fill="none" aria-hidden="true">
                    <path d="M20 6L9 17l-5-5" stroke="#fff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path>
                  </svg>
                </button>
                <button id="contact-delete-btn" class="address-action-btn icon-btn btn-danger" aria-label="Delete saved contact" disabled>
                  <img src="media%20icons/delete.png" alt="Delete contact" width="16" height="16" aria-hidden="true">
                </button>
              </div>
            </div>
          </section>
          <section class="address-section">
            <h2 class="section-label"><img src="media%20icons/add.png" alt="" class="section-label-icon" width="18" height="18" aria-hidden="true">Delivery Address</h2>
              <div class="address-panel">
              <input id="address-field" class="address-field" type="text" placeholder="Add receiving address" value="" aria-label="Delivery address" />
              <div id="address-error" class="input-error" hidden>Delivery address is required</div>
              <div class="address-actions">
                <!-- Save is disabled by default until input has value -->
                <button id="address-save-btn" class="address-action-btn icon-btn btn-primary" aria-label="Save address" disabled>
                  <!-- iPhone-style check icon -->
                  <svg width="18" height="18" viewBox="0 0 24 24" fill="none" aria-hidden="true">
                    <path d="M20 6L9 17l-5-5" stroke="#fff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path>
                  </svg>
                </button>
                <!-- Clear input -->
        
                <!-- Delete selected saved address (disabled until an address is selected) -->
                <button id="address-delete-btn" class="address-action-btn icon-btn btn-danger" aria-label="Delete selected address" disabled>
                  <!-- Delete PNG from media icons folder -->
                  <img src="media%20icons/delete.png" alt="Delete address" width="16" height="16" aria-hidden="true">
                </button>
              </div>
            </div>
            <!-- saved-addresses list removed; we only keep the input field for a single saved address -->
          </section>

          

          <!-- removed duplicate muted continue link; primary orange button above list used instead -->

          <aside class="cart-summary">
            <div class="summary-inner">
              <div class="summary-title">Order Summary</div>
          
              <div class="summary-divider"></div>
              <div class="summary-row total">
                <strong>Total</strong>
                <strong id="total">₦0</strong>
              </div>
              <!-- Inline message area for checkout validation (hidden by default) -->
              <div id="cart-message" class="cart-message" role="alert" aria-live="assertive" hidden></div>
          
              <div class="summary-actions">
                <button id="checkout-btn" class="process-btn" disabled>Process Transaction</button>
                <button id="clear-cart" class="add-cart-btn">Clear cart</button>
              </div>
            </div>
          </aside>
        </section>
        <!-- Mobile bottom checkout bar (visible on small screens) -->
       
      </main>
      <script src="scripts/dynamic.js" defer></script>
  		<script>
  		// Close button: navigate back to referrer or history, fallback to home
  		(function(){
  		  document.addEventListener('DOMContentLoaded', function(){
  		    var btn = document.querySelector('.close-btn');
  		    if (!btn) return;
  		    btn.addEventListener('click', function(e){
  		      e.preventDefault();
  		      try {
  		        if (document.referrer && document.referrer.indexOf(location.origin) === 0) {
  		          window.location.href = document.referrer; return;
  		        }
  		      } catch (err) {}
  		      try { history.back(); setTimeout(function(){ if (!document.hidden) { /* nothing */ } }, 250); }
  		      catch (e) { window.location.href = 'index.html'; }
  		      // final fallback after a short delay
  		      setTimeout(function(){ if (location.pathname.indexOf('cart.html') !== -1) window.location.href = 'index.html'; }, 600);
  		    });
  		  });
  		})();
  		</script>
    </div>
  </body>
</html>
